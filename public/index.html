<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>

</head>
<body>

<div id="time">Time : </div>
<img  id="myimage" src="waldo1.jpeg" height="1250px" width="2000px"/>
    
<button id="show-scores">Afficher les scores</button>

<ul id="score-list"></ul>

</body>
<script type="module">

import { initializeApp } from "firebase/app";
import { getFirestore } from "firebase/firestore";


const db = getFirestore(app);
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyDjPAyUmMGosOlTzEz0whdl8lvHlCk4Stw",
    authDomain: "waldo-f0134.firebaseapp.com",
    projectId: "waldo-f0134",
    storageBucket: "waldo-f0134.appspot.com",
    messagingSenderId: "630658148560",
    appId: "1:630658148560:web:be90b4692bbceb3db1d6d5"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);


    

 let time = Date.now()

    myimage.onclick = function(e) {
        var ratioX = e.target.naturalWidth / e.target.offsetWidth;
        var ratioY = e.target.naturalHeight / e.target.offsetHeight;
      
        var domX = e.x + window.pageXOffset - e.target.offsetLeft;
        var domY = e.y + window.pageYOffset - e.target.offsetTop;
      
        var x = Math.floor(domX * ratioX);
        var y = Math.floor(domY * ratioY);


        if (x > 1194 && x < 1236 && y > 1199 && y < 1311)

        {
            let time2 = Date.now()

            let final = time2 - time

            let final2 = (final/1000).toFixed(0)

            alert(`gg, done in ${final2} seconds`)
        
        }
      
      };

let timer = document.querySelector('#time')

var i = 0;

setInterval(() => {
    i = i + 1;
    timer.innerHTML = `Time : ${i}`;
}, 1000);

import { collection, addDoc } from "firebase/firestore";

async function saveScore(name, time) {
  try {
    const docRef = await addDoc(collection(db, "scores"), {
      name: name,
      time: time,
      timestamp: Date.now(),
    });
    console.log("Score enregistrÃ© avec l'ID: ", docRef.id);
  } catch (e) {
    console.error("Erreur lors de l'enregistrement du score: ", e);
  }
}


saveScore(user_name, time_taken);
import { collection, query, orderBy, limit, getDocs } from "firebase/firestore";


async function displayTopScores() {
  const scoresRef = collection(db, "scores");
  const q = query(scoresRef, orderBy("time", "asc"), limit(10));

  const querySnapshot = await getDocs(q);
  const scoreListElement = document.getElementById("score-list");
  scoreListElement.innerHTML = ""; // Vide la liste avant de la remplir

  let rank = 1;
  querySnapshot.forEach((doc) => {
    const listItem = document.createElement("li");
    listItem.textContent = `${rank}. ${doc.data().name} - ${doc.data().time}`;
    scoreListElement.appendChild(listItem);
    rank++;
  });
}

const showScoresButton = document.getElementById("show-scores");
showScoresButton.addEventListener("click", displayTopScores);
      
</script>

</html>